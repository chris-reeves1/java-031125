Linux namespaces + containers:
------------------------------

A container is a process. 

its like a "light-weight virtual machine", "box that contains your code + dependancies." 

description:
    - runs on any o/s
    - some containers are described in images
    - isolation - filesystem, processes, system resources, users, permission, networks   

namespaces:
mnt: "what can i see"
pid: "what process number do i have"
IPC: "sharing + permissions"
UTS: "whats my name"
net: "how to communicate"
cgroups: "memory + cores available"

user: "identy"
time: "what is the time"

lsns: - show namespaces
ps: show processes

nsenter: enter a custom namespace

unshare: 
sudo unshare --pid --fork --mount-proc /bin/bash

sudo debootstrap --variant=minbase noble /rootfs http://archive.ubuntu.com/ubuntu


-------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------

1) install docker

    curl https://get.docker.com | sudo bash

then optionally:

    sudo usermod -aG docker ubuntu

Check its working ok:
    docker run --rm hello-world

2) image name construction

    [HOST]/[USER]/[NAME]:[TAG]

HOST: defaults to dockerhub.io (alternatives cloud registry, nexus, private server)
USER: unofficial users need their username in the image name. Otherwise can be empty.
NAME: just a name. 
TAG: any metadata tag: v10.10.11, python/java, os, - if empty defaults to "latest". 

3) image commands
    - docker images                  - see downloaded images
    - docker rmi <image-name>          - delete the image
    - docker rmi -f $(docker images)    - delete all images
    - docker tag <old> <new>      - rename image to tag username then push to registry. 
    - docker push <name>        -- push to registry command
    - docker search <name>        - searches dockerhub
    - docker pull <name>        - manually pull an image from dockerhub. 

4) run a container

    docker run -d -p 80:80 --name nginxwebserver nginx

    -d     --detatched mode  - doesnt tka eover our temrinal
    -p     --publish - for publiushing ports. 
            first number is host port and can be any open, free port.
            second is app port and determined by the process/app running. 
    --name     - names the actual container (optional)
    last arg = the image name to use.
    -e    -- pass through env vars
    --network  --attach to a specific network
    -v    - mounts for persistant data storage. 


    docker ps    - shows all running containers
    docker ps -a   - show all container running or stopped. 
    docker rm -f $(docker ps -aq) -- delete all containers 
    docker exec -it <name> bash - enter the container. 

    docker stop <name>
    docker start <name>
    docker rename <old> <new>

    docker logs <name>
    docker inspect <name>

6) build a custom image

    docker build -t name . 

    -t   -- name tag
    .    -- build context - points to the dockerfile. 

inside the Dockerfile:
    FROM - base layer (always an image -- usually official)
    WORKDIR (optional) - sets the working directory.subsequenbt copy/run commnands tagret it. 
    COPY - (optional) copies files to a location in the container. copy . . 
    RUN - (optional) run linux commands in the container. 128 commands + daisy-chaining.
     install reqs for example RUN pip install -r requirements.txt 
    ENV - (optional) environemtn vars ENV VAR="value"
    EXPOSE - (optional) what port does the app run on. 5500 - conventional + for easy viewing. 
    CMD - commands to run on start up..... can be overridden in run command
    ENTRYPOINT - command to run on start up - not changable.
        eg ENTRYPOINT ["python", "app.py"]
    ARG - optional - vars - pass through differnt versions/authors
    LABEL - (optional)metadata - author, data, version, comments... 
    VOLUME - (optional) persistant storage. 
    USER - (optional) replace root!!
    HEALTHCHECK - (optional) 